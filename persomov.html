<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Top Artistas - High Sierra Fix</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: #fff;
            margin: 20px;
        }
        
        h1 {
            color: #1DB954;
            text-align: center;
            font-size: 24px;
            margin: 30px 0;
        }
        
        .contenedor-artistas {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .tarjeta {
            background: #2a2a2a;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
        }
        
        .imagen-artista {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 10px;
            background: #333;
        }
        
        .nombre-artista {
            font-size: 14px;
            margin: 5px 0;
        }
        
        .contador {
            color: #888;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>游댠 Top 20 Artistas Actuales</h1>
    <div class="contenedor-artistas" id="artistas"></div>

<script>
// Configuraci칩n especial para Firefox Legacy
var API_KEY = 'df6a2aca44246cb61eb053e38d7d2a8a';
var PROXY = 'https://api.codetabs.com/v1/proxy/?quest=';
var URL = PROXY + encodeURIComponent('https://ws.audioscrobbler.com/2.0/?method=chart.gettopartists&api_key=' + API_KEY + '&format=json&limit=20');

function cargarDatos() {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', URL, true);
    
    xhr.onload = function() {
        if (xhr.status >= 200 && xhr.status < 300) {
            var datos = JSON.parse(xhr.responseText);
            mostrarDatos(datos.artists.artist);
        } else {
            mostrarError();
        }
    };
    
    xhr.onerror = function() {
        mostrarError();
    };
    
    xhr.send();
}

function mostrarDatos(artistas) {
    var html = '';
    
    for (var i = 0; i < artistas.length; i++) {
        var artista = artistas[i];
        var imagen = obtenerImagenSegura(artista.image);
        var oyentes = parseInt(artista.listeners).toLocaleString('es') || '0';
        
        html += '<div class="tarjeta">' +
                '<img class="imagen-artista" src="' + imagen + '" alt="' + artista.name + '" ' +
                'onerror="this.src=\'https://placehold.co/180x150?text=Imagen+No+Disponible\'">' +
                '<div class="nombre-artista">' + artista.name + '</div>' +
                '<div class="contador">游논 ' + oyentes + ' oyentes</div>' +
                '</div>';
    }
    
    document.getElementById('artistas').innerHTML = html;
}

function obtenerImagenSegura(imagenes) {
    var tama침osPreferidos = ['extralarge', 'large', 'medium'];
    for (var j = 0; j < tama침osPreferidos.length; j++) {
        var tama침o = tama침osPreferidos[j];
        for (var k = 0; k < imagenes.length; k++) {
            if (imagenes[k].size === tama침o && imagenes[k]['#text']) {
                return imagenes[k]['#text'].replace('http://', 'https://') + '?v=' + Date.now();
            }
        }
    }
    return 'https://placehold.co/180x150?text=Sin+Imagen';
}

function mostrarError() {
    document.getElementById('artistas').innerHTML = 
        '<div style="color: #ff4444; text-align: center; padding: 20px;">' +
        '丘멆잺 Error de conexi칩n. Verifica:<br>' +
        '1. Tu conexi칩n a Internet<br>' +
        '2. Extensiones de bloqueo (uBlock, etc.)<br>' +
        '3. Firewall/Antivirus<br>' +
        '<button style="margin-top: 10px; padding: 8px 15px; background: #1DB954; border: none; border-radius: 4px; color: white; cursor: pointer;" onclick="location.reload()">Recargar</button>' +
        '</div>';
}

// Iniciar carga
cargarDatos();
</script>
</body>
</html>